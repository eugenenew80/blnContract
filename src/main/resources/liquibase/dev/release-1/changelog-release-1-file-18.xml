<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
		xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.3.xsd">


	<changeSet id="cm-rus-245" logicalFilePath="path-independent" author="ruslan" context="dev">
		<comment>add column for table: contract_types_tl</comment>
		<addColumn schemaName="apps"
				   tableName="contract_types_tl">
		<column name="attribute" type="varchar2(255)" remarks="Признак"/>
		</addColumn>
	</changeSet>

	<changeSet id="cm-rus-246" logicalFilePath="path-independent" author="ruslan">
		<comment>update comment on cm_doc_keg_cte</comment>
		<sql dbms="postgres, oracle" endDelimiter=";" splitStatements="true" stripComments="true">
			comment on table apps.cm_doc_keg_cte IS 'Договоры на оказание услуг'
		</sql>
	</changeSet>

	<changeSet id="cm-rus-247" logicalFilePath="path-independent" author="ruslan">
		<comment>update comment on contract_types_tl</comment>
		<sql dbms="postgres, oracle" endDelimiter=";" splitStatements="true" stripComments="true">
			UPDATE apps.contract_types_tl
			SET attribute = 'KEGOC'
			WHERE name = 'Передача эл.энергии';
		</sql>
	</changeSet>

	<changeSet id="cm-rus-248" logicalFilePath="path-independent" author="ruslan">
		<comment>update comment on contract_types_tl</comment>
		<sql dbms="postgres, oracle" endDelimiter=";" splitStatements="true" stripComments="true">
			UPDATE apps.contract_types_tl
			SET attribute = 'KEGOC'
			WHERE name = 'Техн.диспетчеризация';
		</sql>
	</changeSet>

	<changeSet id="cm-rus-249" logicalFilePath="path-independent" author="ruslan">
		<comment>update comment on contract_types_tl</comment>
		<sql dbms="postgres, oracle" endDelimiter=";" splitStatements="true" stripComments="true">
			UPDATE apps.contract_types_tl
			SET attribute = 'KEGOC'
			WHERE name = 'Балансирование';
		</sql>
	</changeSet>

	<changeSet id="cm-rus-250" logicalFilePath="path-independent" author="ruslan">
		<comment>update comment on contract_types_tl</comment>
		<sql dbms="postgres, oracle" endDelimiter=";" splitStatements="true" stripComments="true">
			UPDATE apps.contract_types_tl
			SET attribute = 'KEGOC'
			WHERE name = 'Резервирование мощности';
		</sql>
	</changeSet>

	<changeSet id="cm-rus-251" logicalFilePath="path-independent" author="ruslan">
		<comment>update comment on contract_types_tl</comment>
		<sql dbms="postgres, oracle" endDelimiter=";" splitStatements="true" stripComments="true">
			UPDATE apps.contract_types_tl
			SET attribute = 'РФЦ'
			WHERE name = 'Транзит по сетям РЭК';
		</sql>
	</changeSet>

	<changeSet id="cm-rus-252" logicalFilePath="path-independent" author="ruslan">
		<comment>update comment on contract_types_tl</comment>
		<sql dbms="postgres, oracle" endDelimiter=";" splitStatements="true" stripComments="true">
			UPDATE apps.contract_types_tl
			SET attribute = 'РФЦ'
			WHERE name = 'Покупка э/э по фикс.тарифам';
		</sql>
	</changeSet>

	<changeSet id="cm-rus-253" logicalFilePath="path-independent" author="ruslan">
		<comment>update comment on contract_types_tl</comment>
		<sql dbms="postgres, oracle" endDelimiter=";" splitStatements="true" stripComments="true">
			UPDATE apps.contract_types_tl
			SET attribute = 'РФЦ'
			WHERE name = 'Покупка э/э по тарифам в ТЭО';
		</sql>
	</changeSet>

	<changeSet id="cm-rus-254" logicalFilePath="path-independent" author="ruslan">
		<comment>update comment on contract_types_tl</comment>
		<sql dbms="postgres, oracle" endDelimiter=";" splitStatements="true" stripComments="true">
			UPDATE apps.contract_types_tl
			SET attribute = 'РФЦ'
			WHERE name = 'Продажа э/э УП';
		</sql>
	</changeSet>

	<changeSet id="cm-rus-255" logicalFilePath="path-independent" author="ruslan" context="dev">
		<comment>add column for table: contract_types_tl</comment>
		<addColumn schemaName="apps"
				   tableName="contract_types_tl">
			<column name="deviations_range" type="varchar2(30)" remarks="Диапазон отклонений в %"/>
		</addColumn>
	</changeSet>

	<changeSet id="cm-rus-256" logicalFilePath="path-independent" author="ruslan" context="dev">
		<comment>Creating foreign constraint: cm_doc_keg_cte_a3h to dict_business_partners</comment>
		<addForeignKeyConstraint
				baseTableSchemaName="apps"
				baseTableName="cm_doc_keg_cte_a3h"
				baseColumnNames="bp1_id"
				constraintName="cm_doc_keg_cte_a3h_2"
				deferrable="true"
				initiallyDeferred="true"
				onDelete="RESTRICT"
				onUpdate="RESTRICT"
				referencedTableSchemaName="apps"
				referencedTableName="dict_business_partners"
				referencedColumnNames="id"
		/>
	</changeSet>

	<changeSet id="cm-rus-257" logicalFilePath="path-independent" author="ruslan" context="dev">
		<comment>Creating foreign constraint: cm_doc_keg_cte_a3h to dict_business_partners</comment>
		<addForeignKeyConstraint
				baseTableSchemaName="apps"
				baseTableName="cm_doc_keg_cte_a3h"
				baseColumnNames="bp2_id"
				constraintName="cm_doc_keg_cte_a3h_3"
				deferrable="true"
				initiallyDeferred="true"
				onDelete="RESTRICT"
				onUpdate="RESTRICT"
				referencedTableSchemaName="apps"
				referencedTableName="dict_business_partners"
				referencedColumnNames="id"
		/>
	</changeSet>

	<changeSet id="cm-rus-258" logicalFilePath="path-independent" author="ruslan" context="dev">
		<comment>Creating foreign constraint: cm_doc_keg_cte_a3h to dict_organizations</comment>
		<addForeignKeyConstraint
				baseTableSchemaName="apps"
				baseTableName="cm_doc_keg_cte_a3h"
				baseColumnNames="org_id"
				constraintName="cm_doc_keg_cte_a3h_4"
				deferrable="true"
				initiallyDeferred="true"
				onDelete="RESTRICT"
				onUpdate="RESTRICT"
				referencedTableSchemaName="apps"
				referencedTableName="dict_organizations"
				referencedColumnNames="id"
		/>
	</changeSet>

</databaseChangeLog>
